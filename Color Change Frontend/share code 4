async def animation_worker():
    global stop_requested, current_anim
    while True:
        if animation_queue:
            with animation_lock:
                req = animation_queue.popleft()
            stop_requested = False
            current_anim = req.animation_type

            # ... your existing conditions ...

            elif req.animation_type == "random_colors":
                await random_colors_loop()

            # ... rest of your conditions ...
