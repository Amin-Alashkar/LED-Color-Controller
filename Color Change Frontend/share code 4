// about.js
// -------- About modal logic - simplified version --------

const aboutBtn = document.getElementById('aboutBtn');
const aboutModal = document.getElementById('aboutModal');
const aboutClose = document.getElementById('aboutClose');

// Enhanced modal functions
async function openAbout() {
    if (!aboutModal) return;
    
    // Prevent multiple openings
    if (aboutModal.classList.contains('show')) return;
    
    // Add loading state to button
    aboutBtn.classList.add('loading');
    aboutBtn.innerHTML = 'Loading...';
    
    await new Promise(resolve => setTimeout(resolve, 300));
    
    // Show modal with animation
    aboutModal.classList.add('show');
    aboutModal.setAttribute('aria-hidden', 'false');
    document.body.classList.add('modal-open');
    
    // Restore button state
    aboutBtn.classList.remove('loading');
    aboutBtn.innerHTML = 'About';
    
    // Focus management
    aboutClose.focus();
}

function closeAbout() {
    if (!aboutModal) return;
    
    // Add closing animation
    aboutModal.style.animation = 'aboutFadeOut 0.25s ease-in both';
    
    setTimeout(() => {
        aboutModal.classList.remove('show');
        aboutModal.setAttribute('aria-hidden', 'true');
        aboutModal.style.animation = '';
        document.body.classList.remove('modal-open');
        aboutBtn.focus();
    }, 250);
}

// Enhanced event listeners
if (aboutBtn) {
    aboutBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        await openAbout();
    });
    
    // Add ripple effect to button
    aboutBtn.addEventListener('click', function(e) {
        const ripple = document.createElement('span');
        const rect = this.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = e.clientX - rect.left - size / 2;
        const y = e.clientY - rect.top - size / 2;
        
        ripple.style.cssText = `
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple 0.6s linear;
            width: ${size}px;
            height: ${size}px;
            left: ${x}px;
            top: ${y}px;
            pointer-events: none;
        `;
        
        this.appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 600);
    });
}

if (aboutClose) {
    aboutClose.addEventListener('click', (e) => {
        e.preventDefault();
        closeAbout();
    });
}

// Enhanced backdrop click
aboutModal.addEventListener('click', (e) => {
    if (e.target === aboutModal) {
        closeAbout();
    }
});

// Enhanced keyboard navigation
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && aboutModal.classList.contains('show')) {
        closeAbout();
    }
});

const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        to {
            transform: scale(4);
            opacity: 0;
        }
    }
    
    @keyframes aboutFadeOut {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.95); }
    }
    
    .about-btn.loading {
        opacity: 0.7;
        pointer-events: none;
    }
`;

document.head.appendChild(style);

// Export for global access
window.AboutModal = {
    open: openAbout,
    close: closeAbout
};
