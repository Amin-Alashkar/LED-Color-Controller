async def single_snake_loop():
    """
    إنيميشن الشهاب بستايل Time Warp مع طول عشوائي:
    - يتحرك من نهاية الشريط للبداية
    - طول الشهاب عشوائي بين 10 و 35 LED
    - يبدأ ببطء ثم يسرع ويتباطأ بشكل سلس
    - سرعة الحركة عشوائية لكل شهاب
    """
    global stop_requested

    while not stop_requested:
        # طول الشهاب عشوائي
        trail_length = random.randint(10, 35)

        # لون الشهاب عشوائي
        color = (
            random.randint(100, 255),
            random.randint(100, 255),
            random.randint(100, 255)
        )

        # اختيار سرعة عشوائية لكل شهاب
        max_speed = random.uniform(0.005, 0.02)
        min_speed = random.uniform(0.05, 0.15)

        # وقت انتظار عشوائي قبل البداية
        wait_time = random.uniform(0, 10)
        await asyncio.sleep(wait_time)

        t = 0
        for head_pos in range(NUM_LEDS - 1, -trail_length - 1, -1):
            if stop_requested:
                break

            neo.clear_strip()
            for t_pos in range(trail_length):
                led_pos = head_pos + t_pos
                if 0 <= led_pos < NUM_LEDS:
                    factor = (trail_length - t_pos) / trail_length
                    r = int(color[0] * factor)
                    g = int(color[1] * factor)
                    b = int(color[2] * factor)
                    neo.set_led_color(
                        led_pos,
                        int(r * BRIGHTNESS_SCALE),
                        int(g * BRIGHTNESS_SCALE),
                        int(b * BRIGHTNESS_SCALE)
                    )

            neo.update_strip()

            # السرعة المتغيرة مثل Time Warp
            speed_factor = (math.sin(t) + 1) / 2  # بين 0 و 1
            current_delay = max_speed + (1 - speed_factor) * (min_speed - max_speed)

            await asyncio.sleep(current_delay)
            t += 0.15
