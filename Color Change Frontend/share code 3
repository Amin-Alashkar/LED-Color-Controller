async def custom_tunnel_effect_loop(hex_color: str, delay: float = 0.05):
    """
    Custom Tunnel Effect:
    - Light moves from both ends toward center in chosen color.
    """
    global stop_requested
    r_base = int(hex_color[1:3], 16)
    g_base = int(hex_color[3:5], 16)
    b_base = int(hex_color[5:7], 16)

    while not stop_requested:
        for step in range((NUM_LEDS // 2) + 1):
            if stop_requested:
                neo.clear_strip()
                neo.update_strip()
                return
            neo.clear_strip()
            for i in range(NUM_LEDS):
                if i == step or i == NUM_LEDS - 1 - step:
                    neo.set_led_color(i, r_base, g_base, b_base)
            neo.update_strip()
            await asyncio.sleep(delay)
        # ثم يعود
        for step in range((NUM_LEDS // 2) + 1):
            if stop_requested:
                neo.clear_strip()
                neo.update_strip()
                return
            neo.clear_strip()
            for i in range(NUM_LEDS):
                if i == (NUM_LEDS // 2) - step or i == (NUM_LEDS // 2) + step:
                    neo.set_led_color(i, r_base, g_base, b_base)
            neo.update_strip()
            await asyncio.sleep(delay)

    neo.clear_strip()
    neo.update_strip()
